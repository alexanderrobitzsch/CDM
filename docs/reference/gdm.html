<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>General Diagnostic Model — gdm • CDM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="General Diagnostic Model — gdm"><meta property="og:description" content="This function estimates the general diagnostic model
(von Davier, 2008; Xu &amp;amp; von Davier, 2008) which handles
multidimensional item response models with ordered discrete
or continuous latent variables for polytomous item
responses."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">8.4</span
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexanderrobitzsch/CDM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>General Diagnostic Model</h1>
    
    <div class="hidden name"><code>gdm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function estimates the general diagnostic model
(von Davier, 2008; Xu &amp; von Davier, 2008) which handles
multidimensional item response models with ordered discrete
or continuous latent variables for polytomous item
responses.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gdm</span><span class="op">(</span> <span class="va">data</span>, <span class="va">theta.k</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, group<span class="op">=</span><span class="cn">NULL</span>, weights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Qmatrix<span class="op">=</span><span class="cn">NULL</span>, thetaDes<span class="op">=</span><span class="cn">NULL</span>, skillspace<span class="op">=</span><span class="st">"loglinear"</span>,</span>
<span>    b.constraint<span class="op">=</span><span class="cn">NULL</span>, a.constraint<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    mean.constraint<span class="op">=</span><span class="cn">NULL</span>, Sigma.constraint<span class="op">=</span><span class="cn">NULL</span>, delta.designmatrix<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    standardized.latent<span class="op">=</span><span class="cn">FALSE</span>, centered.latent<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    centerintercepts<span class="op">=</span><span class="cn">FALSE</span>, centerslopes<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>    maxiter<span class="op">=</span><span class="fl">1000</span>,  conv<span class="op">=</span><span class="fl">1e-5</span>, globconv<span class="op">=</span><span class="fl">1e-5</span>, msteps<span class="op">=</span><span class="fl">4</span>, convM<span class="op">=</span><span class="fl">.0005</span>,</span>
<span>    decrease.increments<span class="op">=</span><span class="cn">FALSE</span>, use.freqpatt<span class="op">=</span><span class="cn">FALSE</span>, progress<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>    PEM<span class="op">=</span><span class="cn">FALSE</span>, PEM_itermax<span class="op">=</span><span class="va">maxiter</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gdm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, file<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gdm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for gdm</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, perstype<span class="op">=</span><span class="st">"EAP"</span>, group<span class="op">=</span><span class="fl">1</span>, barwidth<span class="op">=</span><span class="fl">.1</span>, histcol<span class="op">=</span><span class="fl">1</span>,</span>
<span>       cexcor<span class="op">=</span><span class="fl">3</span>, pchpers<span class="op">=</span><span class="fl">16</span>, cexpers<span class="op">=</span><span class="fl">.7</span>, <span class="va">...</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>An \(N \times I\) matrix of polytomous item
    responses with categories \(k=0,1,...,K\)</p></dd>

  <dt>theta.k</dt>
<dd><p>In the one-dimensional case it must be a vector.
For multidimensional models it has to be a list
of skill vectors if the theta grid differs between
dimensions. If not, a vector input can be supplied.
If an estimated skillspace (<code>skillspace="est"</code> should be estimated,
a vector or a matrix <code>theta.k</code> will be used as initial values of the estimated
\(\bold{\theta}\) grid.</p></dd>

  <dt>irtmodel</dt>
<dd><p>The default <code>2PL</code> corresponds to the model
where item slopes on dimensions are equal for all
item categories. If item-category slopes should
be estimated, use <code>2PLcat</code>. If no item slopes
should be estimated then <code>1PL</code> can be selected.
Note that fixed item slopes can be specified in
the Q-matrix (argument <code>Qmatrix</code>).</p></dd>

  <dt>group</dt>
<dd><p>An optional vector of group identifiers for
multiple group estimation.
For <code>plot.gdm</code> it is an integer indicating which
  group should be used for plotting.</p></dd>

  <dt>weights</dt>
<dd><p>An optional vector of sample weights</p></dd>

  <dt>Qmatrix</dt>
<dd><p>An optional array of dimension \(I \times D \times K\)
which indicates pre-specified item loadings
on dimensions. The default for category \(k\) is the score \(k\), i.e.
the scoring in the (generalized) partial credit model.</p></dd>

<dt>thetaDes</dt>
<dd><p>A design matrix for specifying nonlinear item response
functions (see Example 1, Models 4 and 5)</p></dd>

  <dt>skillspace</dt>
<dd><p>The parametric assumption of the skillspace.
If <code>skillspace="normal"</code> then a univariate or
multivariate normal distribution is assumed.
The default <code>"loglinear"</code> corresponds to log-linear
smoothing of the skillspace distribution (Xu &amp; von Davier, 2008).
If <code>skillspace="full"</code>, then all probabilities of the skill space
are nonparametrically estimated. If <code>skillspace="est"</code>, then the
\(\bold{\theta}\) distribution vectors will be estimated
(see Details and Examples 4 and 5; Bartolucci, 2007).</p></dd>

  <dt>b.constraint</dt>
<dd><p>In this optional matrix with \(C_b\) rows and three columns,
\(C_b\) item intercepts \(b_{ik}\) can be fixed.
1st column: item index, 2nd column: category index,
3rd column: fixed item thresholds</p></dd>

  <dt>a.constraint</dt>
<dd><p>In this optional matrix with \(C_a\) rows and four columns,
\(C_a\) item intercepts \(a_{idk}\) can be fixed.
1st column: item index, 2nd column: dimension index,
3rd column: category index, 4th column: fixed item slopes <br></p></dd>

<dt>mean.constraint</dt>
<dd><p>A \(C \times 3\) matrix for
  constraining \(C\) means in the
  normal distribution assumption (<code>skillspace="normal"</code>).
  1st column: Dimension, 2nd column: Group, 3rd column: Value</p></dd>

<dt>Sigma.constraint</dt>
<dd><p>A \(C \times 4\) matrix for
  constraining \(C\) covariances in the
  normal distribution assumption (<code>skillspace="normal"</code>).
  1st column: Dimension 1, 2nd column: Dimension 2,
  3rd column: Group, 4th column: Value</p></dd>

  <dt>delta.designmatrix</dt>
<dd><p>The design matrix of \(\delta\) parameters
for the reduced skillspace estimation (see Xu &amp;
von Davier, 2008)</p></dd>

<dt>standardized.latent</dt>
<dd><p>A logical indicating whether in a uni- or multidimensional
model all latent variables of the first group should be normally distributed
and standardized. The default is <code>FALSE</code>.</p></dd>

<dt>centered.latent</dt>
<dd><p>A logical indicating whether in a uni- or multidimensional
    model all latent variables of the first group should be normally
    distributed and do have zero means? The default is <code>FALSE</code>.</p></dd>

<dt>centerintercepts</dt>
<dd><p>A logical indicating whether intercepts should be centered to have a
    mean of 0 for all dimensions. This argument does not (yet) work properly
    for varying numbers of item categories.</p></dd>

<dt>centerslopes</dt>
<dd><p>A logical indicating whether item slopes should be centered to have
    a mean of 1 for all dimensions. This argument only works for
    <code>irtmodel="2PL"</code>. The default is <code>FALSE</code>.</p></dd>

  <dt>maxiter</dt>
<dd><p>Maximum number of iterations</p></dd>

  <dt>conv</dt>
<dd><p>Convergence criterion for item parameters and
distribution parameters</p></dd>

  <dt>globconv</dt>
<dd><p>Global deviance convergence criterion</p></dd>

<dt>msteps</dt>
<dd><p>Maximum number of M steps in estimating \(b\) and
    \(a\) item parameters. The default is to use 4 M steps.</p></dd>

<dt>convM</dt>
<dd><p>Convergence criterion in M step</p></dd>

<dt>decrease.increments</dt>
<dd><p>Should in the M step the increments
    of \(a\) and \(b\) parameters decrease during iterations?
    The default is <code>FALSE</code>. If there is an increase in deviance
    during estimation, setting <code>decrease.increments</code> to <code>TRUE</code>
    is recommended.</p></dd>

<dt>use.freqpatt</dt>
<dd><p>A logical indicating whether frequencies of unique item response patterns
    should be used. In case of large data set <code>use.freqpatt=TRUE</code>
    can speed calculations (depending on the problem).
    Note that in this case, not all person parameters are calculated
    as usual in the output.</p></dd>

  <dt>progress</dt>
<dd><p>An optional logical indicating whether the function should print the
     progress of iteration in the estimation process.</p></dd>

<dt>PEM</dt>
<dd><p>Logical indicating whether the P-EM acceleration should be
applied (Berlinet &amp; Roland, 2012).</p></dd>

<dt>PEM_itermax</dt>
<dd><p>Number of iterations in which the P-EM method should be
applied.</p></dd>

  <dt>object</dt>
<dd><p>A required object of class <code>gdm</code></p></dd>

<dt>file</dt>
<dd><p>Optional file name for a file in which <code>summary</code>
should be sinked.</p></dd>

  <dt>x</dt>
<dd><p>A required object of class <code>gdm</code></p></dd>

<dt>perstype</dt>
<dd><p>Person parameter estimate type. Can be either
<code>"EAP"</code>, <code>"MAP"</code> or <code>"MLE"</code>.</p></dd>

<dt>barwidth</dt>
<dd><p>Bar width in <code>plot.gdm</code></p></dd>

<dt>histcol</dt>
<dd><p>Color of histogram bars in <code>plot.gdm</code></p></dd>

<dt>cexcor</dt>
<dd><p>Font size for print of correlation in <code>plot.gdm</code></p></dd>

<dt>pchpers</dt>
<dd><p>Point type for scatter plot of person
parameters in <code>plot.gdm</code></p></dd>

<dt>cexpers</dt>
<dd><p>Point size for scatter plot of person
parameters in <code>plot.gdm</code></p></dd>

  <dt>...</dt>
<dd><p>Optional parameters to be passed to or from other
    methods will be ignored.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Case <code>irtmodel="1PL"</code>: <br>
Equal item slopes of 1 are assumed in this model. Therefore,
it corresponds to a generalized multidimensional Rasch model.
$$logit P( X_{nj}=k | \theta_n )=b_{j0} +
    \sum_d q_{jdk} \theta_{nd} $$
The Q-matrix entries \(q_{jdk}\) are pre-specified by the user.</p>
<p>Case <code>irtmodel="2PL"</code>: <br>
For each item and each dimension, different item slopes \(a_{jd}\)
are estimated:
$$logit P( X_{nj}=k | \theta_n )=b_{j0} +
    \sum_d a_{jd} q_{jdk} \theta_{nd} $$
Case <code>irtmodel="2PLcat"</code>: <br>
For each item, each dimension and each category,
different item slopes \(a_{jdk}\)
are estimated:
$$logit P( X_{nj}=k | \theta_n )=b_{j0} +
    \sum_d a_{jdk} q_{jdk} \theta_{nd} $$</p>
<p>Note that this model can be generalized to include terms of
any transformation \(t_h\) of the \(\theta_n\) vector (e.g. quadratic terms,
step functions or interaction) such that the model can be formulated as
$$logit P( X_{nj}=k | \theta_n )=b_{j0} +
    \sum_h a_{jhk} q_{jhk} t_h( \theta_{n} ) $$
In general, the number of functions \(t_1, ..., t_H\) will be
larger than the \(\theta\) dimension of \(D\).</p>
<p>The estimation follows an EM algorithm as described in von Davier and
Yamamoto (2004) and von Davier (2008).</p>
<p>In case of <code>skillspace="est"</code>, the \(\bold{\theta}\) vectors
(the grid of the theta distribution) are estimated (Bartolucci, 2007;
Bacci, Bartolucci &amp; Gnaldi, 2012). This model is called a multidimensional
latent class item response model.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>gdm</code>. The list contains the
following entries:</p>
<dl><dt>item</dt>
<dd><p>Data frame with item parameters</p></dd>

<dt>person</dt>
<dd><p>Data frame with person parameters:
    <code>EAP</code> denotes the mean of the individual posterior distribution,
    <code>SE.EAP</code> the corresponding standard error,
    <code>MLE</code> the maximum likelihood estimate at <code>theta.k</code>
    and <code>MAP</code> the mode of the posterior distribution</p></dd>

<dt>EAP.rel</dt>
<dd><p>Reliability of the EAP</p></dd>

<dt>deviance</dt>
<dd><p>Deviance</p></dd>

<dt>ic</dt>
<dd><p>Information criteria, number of estimated parameters</p></dd>

<dt>b</dt>
<dd><p>Item intercepts \(b_{jk}\)</p></dd>

<dt>se.b</dt>
<dd><p>Standard error of item intercepts \(b_{jk}\)</p></dd>

<dt>a</dt>
<dd><p>Item slopes \(a_{jd}\) resp. \(a_{jdk}\)</p></dd>

<dt>se.a</dt>
<dd><p>Standard error of item slopes \(a_{jd}\) resp. \(a_{jdk}\)</p></dd>

<dt>itemfit.rmsea</dt>
<dd><p>The RMSEA item fit index (see <code><a href="itemfit.rmsea.html">itemfit.rmsea</a></code>).
    This entry comes as a list with total and group-wise item fit
    statistics.</p></dd>

<dt>mean.rmsea</dt>
<dd><p>Mean of RMSEA item fit indexes.</p></dd>

<dt>Qmatrix</dt>
<dd><p>Used Q-matrix</p></dd>

<dt>pi.k</dt>
<dd><p>Trait distribution</p></dd>

<dt>mean.trait</dt>
<dd><p>Means of trait distribution</p></dd>

<dt>sd.trait</dt>
<dd><p>Standard deviations of trait distribution</p></dd>

<dt>skewness.trait</dt>
<dd><p>Skewnesses of trait distribution</p></dd>

<dt>correlation.trait</dt>
<dd><p>List of correlation matrices of trait distribution
      corresponding to each group</p></dd>

<dt>pjk</dt>
<dd><p>Item response probabilities evaluated at grid <code>theta.k</code></p></dd>

<dt>n.ik</dt>
<dd><p>An array of expected counts \(n_{cikg}\) of ability class \(c\)
    at item \(i\) at category \(k\) in group \(g\)</p></dd>

<dt>G</dt>
<dd><p>Number of groups</p></dd>

<dt>D</dt>
<dd><p>Number of dimension of \(\bold{\theta}\)</p></dd>

<dt>I</dt>
<dd><p>Number of items</p></dd>

<dt>N</dt>
<dd><p>Number of persons</p></dd>

<dt>delta</dt>
<dd><p>Parameter estimates for skillspace representation</p></dd>

<dt>covdelta</dt>
<dd><p>Covariance matrix of parameter estimates for
      skillspace representation</p></dd>

<dt>data</dt>
<dd><p>Original data frame</p></dd>

<dt>group.stat</dt>
<dd><p>Group statistics (sample sizes, group labels)</p></dd>

<dt>p.xi.aj</dt>
<dd><p>Individual likelihood</p></dd>

<dt>posterior</dt>
<dd><p>Individual posterior distribution</p></dd>

<dt>skill.levels</dt>
<dd><p>Number of skill levels per dimension</p></dd>

<dt>K.item</dt>
<dd><p>Maximal category per item</p></dd>

<dt>theta.k</dt>
<dd><p>Used theta design or estimated theta trait distribution
    in case of <code>skillspace="est"</code></p></dd>

<dt>thetaDes</dt>
<dd><p>Used theta design for item responses</p></dd>

<dt>se.theta.k</dt>
<dd><p>Estimated standard errors of <code>theta.k</code> if it is
    estimated</p></dd>

<dt>time</dt>
<dd><p>Info about computation time</p></dd>

<dt>skillspace</dt>
<dd><p>Used skillspace parametrization</p></dd>

<dt>iter</dt>
<dd><p>Number of iterations</p></dd>

<dt>converged</dt>
<dd><p>Logical indicating whether convergence was achieved.</p></dd>

<dt>object</dt>
<dd><p>Object of class <code>gdm</code></p></dd>

<dt>x</dt>
<dd><p>Object of class <code>gdm</code></p></dd>

<dt>perstype</dt>
<dd><p>Person paramter estimate type. Can be either
<code>"EAP"</code>, <code>"MAP"</code> or <code>"MLE"</code>.</p></dd>

<dt>group</dt>
<dd><p>Group which should be used for <code>plot.gdm</code></p></dd>

<dt>barwidth</dt>
<dd><p>Bar width in <code>plot.gdm</code></p></dd>

<dt>histcol</dt>
<dd><p>Color of histogram bars in <code>plot.gdm</code></p></dd>

<dt>cexcor</dt>
<dd><p>Font size for print of correlation in <code>plot.gdm</code></p></dd>

<dt>pchpers</dt>
<dd><p>Point type for scatter plot of person
parameters in <code>plot.gdm</code></p></dd>

<dt>cexpers</dt>
<dd><p>Point size for scatter plot of person
parameters in <code>plot.gdm</code></p></dd>

<dt>...</dt>
<dd><p>Optional parameters to be passed to or from other
    methods will be ignored.</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Bacci, S., Bartolucci, F., &amp; Gnaldi, M. (2012).
A class of multidimensional latent class IRT models for ordinal
polytomous item responses. <em>arXiv preprint</em>, <em>arXiv:1201.4667</em>.</p>
<p>Bartolucci, F. (2007). A class of multidimensional IRT models for testing
unidimensionality and clustering items. <em>Psychometrika, 72</em>, 141-157.</p>
<p>Berlinet, A. F., &amp; Roland, C. (2012).
Acceleration of the EM algorithm: P-EM versus epsilon algorithm.
<em>Computational Statistics &amp; Data Analysis</em>, <b>56</b>(12), 4122-4137.</p>
<p>von Davier, M. (2008). A general diagnostic model applied to
language testing data. <em>British Journal
of Mathematical and Statistical Psychology, 61</em>, 287-307.</p>
<p>von Davier, M., &amp; Yamamoto, K. (2004). Partially observed mixtures of IRT models:
An extension of the generalized partial-credit model.
<em>Applied Psychological Measurement, 28</em>, 389-406.</p>
<p>Xu, X., &amp; von Davier, M. (2008). <em>Fitting the structured general diagnostic
model to NAEP data</em>. ETS Research Report ETS RR-08-27. Princeton, ETS.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Cognitive diagnostic models for dichotomous data can be estimated
with <code><a href="din.html">din</a></code> (DINA or DINO model) or <code><a href="gdina.html">gdina</a></code>
(GDINA model, which contains many CDMs as special cases).</p>
<p>For assessment of model fit see <code><a href="modelfit.cor.html">modelfit.cor.din</a></code> and
<code><a href="anova.din.html">anova.gdm</a></code>.</p>
<p>See <code><a href="itemfit.sx2.html">itemfit.sx2</a></code> for item fit statistics.</p>
<p>For the estimation of the multidimensional
latent class item response model see the <span class="pkg">MultiLCIRT</span> package
and <b>sirt</b> package (function <code><a href="https://rdrr.io/pkg/sirt/man/rasch.mirtlc.html" class="external-link">sirt::rasch.mirtlc</a></code>).</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Fraction Dataset 1</span></span>
<span><span class="co">#      Unidimensional Models for dichotomous data</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.fraction1</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.fraction1</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span>, len<span class="op">=</span><span class="fl">15</span> <span class="op">)</span>   <span class="co"># discretized ability</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 1: Rasch model (normal distribution)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>               centered.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 2: Rasch model (log-linear smoothing)</span></span>
<span><span class="co"># set the item difficulty of the 8th item to zero</span></span>
<span><span class="va">b.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">3</span> <span class="op">)</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>               skillspace<span class="op">=</span><span class="st">"loglinear"</span>, b.constraint<span class="op">=</span><span class="va">b.constraint</span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 3: 2PL model</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>               skillspace<span class="op">=</span><span class="st">"normal"</span>, standardized.latent<span class="op">=</span><span class="cn">TRUE</span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 4: include quadratic term in item response function</span></span>
<span><span class="co">#   using the argument decrease.increments=TRUE leads to a more</span></span>
<span><span class="co">#   stable estimate</span></span>
<span><span class="va">thetaDes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">theta.k</span>, <span class="va">theta.k</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">thetaDes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"F1"</span>, <span class="st">"F1q"</span> <span class="op">)</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>          thetaDes<span class="op">=</span><span class="va">thetaDes</span>, skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>          standardized.latent<span class="op">=</span><span class="cn">TRUE</span>, decrease.increments<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 5: step function for ICC</span></span>
<span><span class="co">#          two different probabilities theta &lt; 0 and theta &gt; 0</span></span>
<span><span class="va">thetaDes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">theta.k</span><span class="op">&gt;</span><span class="fl">0</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">thetaDes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="st">"Fgrm1"</span> <span class="op">)</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>          thetaDes<span class="op">=</span><span class="va">thetaDes</span>, skillspace<span class="op">=</span><span class="st">"normal"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 6: DINA model with din function</span></span>
<span><span class="va">mod6</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="din.html">din</a></span><span class="op">(</span> <span class="va">dat</span>, q.matrix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fl">1</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">1</span> <span class="op">)</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 7: Estimating a version of the DINA model with gdm</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">.5</span>,<span class="fl">.5</span><span class="op">)</span></span>
<span><span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"loglinear"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 2: Cultural Activities - data.Students</span></span>
<span><span class="co">#      Unidimensional Models for polytomous data</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.Students</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.Students</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span> <span class="st">"act"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, len<span class="op">=</span><span class="fl">11</span> <span class="op">)</span>   <span class="co"># discretized ability</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 1: Partial Credit Model (PCM)</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>           centered.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 1b: PCM using frequency patterns</span></span>
<span><span class="va">mod1b</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>           centered.latent<span class="op">=</span><span class="cn">TRUE</span>, use.freqpatt<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 2: PCM with two groups</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>            group<span class="op">=</span><span class="fu">CDM</span><span class="fu">::</span><span class="va"><a href="data.Students.html">data.Students</a></span><span class="op">$</span><span class="va">urban</span> <span class="op">+</span> <span class="fl">1</span>, skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>            centered.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 3: PCM with loglinear smoothing</span></span>
<span><span class="va">b.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span> <span class="op">)</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>    skillspace<span class="op">=</span><span class="st">"loglinear"</span>, b.constraint<span class="op">=</span><span class="va">b.constraint</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 4: Model with pre-specified item weights in Q-matrix</span></span>
<span><span class="va">Qmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span> <span class="fl">1</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">Qmatrix</span><span class="op">[</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span>     <span class="co"># default is score 2 for category 2</span></span>
<span><span class="co"># now change the scoring of category 2:</span></span>
<span><span class="va">Qmatrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.74</span></span>
<span><span class="va">Qmatrix</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2.3</span></span>
<span><span class="co"># for items 2 and 4 the score for category 1 is .74 and for category 2 it is 2.3</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>           skillspace<span class="op">=</span><span class="st">"normal"</span>, centered.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 5: Generalized partial credit model</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>          skillspace<span class="op">=</span><span class="st">"normal"</span>, standardized.latent<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 6: Item-category slope estimation</span></span>
<span><span class="va">mod6</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PLcat"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,  skillspace<span class="op">=</span><span class="st">"normal"</span>,</span>
<span>                 standardized.latent<span class="op">=</span><span class="cn">TRUE</span>, decrease.increments<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Models 7: items with different number of categories</span></span>
<span><span class="va">dat0</span> <span class="op">&lt;-</span> <span class="va">dat</span></span>
<span><span class="va">dat0</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">dat0</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span>, <span class="fl">1</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># 1st item has only two categories</span></span>
<span><span class="va">dat0</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">dat0</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fl">2</span>, <span class="fl">3</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># 3rd item has only two categories</span></span>
<span></span>
<span><span class="co"># Model 7a: PCM</span></span>
<span><span class="va">mod7a</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat0</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,  centered.latent<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7a</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 7b: Item category slopes</span></span>
<span><span class="va">mod7b</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat0</span>, irtmodel<span class="op">=</span><span class="st">"2PLcat"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,</span>
<span>                 standardized.latent<span class="op">=</span><span class="cn">TRUE</span>, decrease.increments<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7b</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 3: Fraction Dataset 2</span></span>
<span><span class="co">#      Multidimensional Models for dichotomous data</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.fraction2</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.fraction2</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="va">Qmatrix</span> <span class="op">&lt;-</span> <span class="va">data.fraction2</span><span class="op">$</span><span class="va">q.matrix3</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 1: One-dimensional Rasch model</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span>, len<span class="op">=</span><span class="fl">11</span> <span class="op">)</span>   <span class="co"># discretized ability</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,  centered.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 2: One-dimensional 2PL model</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, standardized.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 3: 3-dimensional Rasch Model (normal distribution)</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>            centered.latent<span class="op">=</span><span class="cn">TRUE</span>,  globconv<span class="op">=</span><span class="fl">5</span><span class="op">*</span><span class="fl">1E-3</span>, conv<span class="op">=</span><span class="fl">1E-4</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 4: 3-dimensional Rasch model (loglinear smoothing)</span></span>
<span><span class="co"># set some item parameters of items 4,1 and 2 to zero</span></span>
<span><span class="va">b.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span> <span class="op">)</span></span>
<span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>              b.constraint<span class="op">=</span><span class="va">b.constraint</span>, skillspace<span class="op">=</span><span class="st">"loglinear"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 5: define a different theta grid for each dimension</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="st">"Dim1"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, len<span class="op">=</span><span class="fl">11</span> <span class="op">)</span>,</span>
<span>                 <span class="st">"Dim2"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span>,len<span class="op">=</span><span class="fl">8</span><span class="op">)</span>,</span>
<span>                 <span class="st">"Dim3"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span>,len<span class="op">=</span><span class="fl">6</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>                 b.constraint<span class="op">=</span><span class="va">b.constraint</span>,  skillspace<span class="op">=</span><span class="st">"loglinear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 6: multdimensional 2PL model (normal distribution)</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, len<span class="op">=</span><span class="fl">13</span> <span class="op">)</span></span>
<span><span class="va">a.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">)</span> <span class="co"># fix some slopes to 1</span></span>
<span><span class="va">mod6</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,  Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>            centered.latent<span class="op">=</span><span class="cn">TRUE</span>, a.constraint<span class="op">=</span><span class="va">a.constraint</span>, decrease.increments<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>            skillspace<span class="op">=</span><span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 7: multdimensional 2PL model (loglinear distribution)</span></span>
<span><span class="va">a.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span> <span class="op">)</span></span>
<span><span class="va">b.constraint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span> <span class="op">)</span></span>
<span><span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>,  Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>,</span>
<span>               b.constraint<span class="op">=</span><span class="va">b.constraint</span>,  a.constraint<span class="op">=</span><span class="va">a.constraint</span>,</span>
<span>               decrease.increments<span class="op">=</span><span class="cn">FALSE</span>, skillspace<span class="op">=</span><span class="st">"loglinear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 4: Unidimensional latent class 1PL IRT model</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co"># simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">754</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">20</span>     <span class="co"># number of items</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2000</span>   <span class="co"># number of persons</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span><span class="op">/</span><span class="fl">4</span>,<span class="va">N</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">*</span><span class="va">N</span><span class="op">/</span><span class="fl">8</span>, <span class="va">N</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>  <span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,len<span class="op">=</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexanderrobitzsch/sirt" class="external-link">sirt</a></span><span class="op">)</span>   <span class="co"># use function sim.raschtype from sirt package</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sirt/man/sim.raschtype.html" class="external-link">sim.raschtype</a></span><span class="op">(</span> theta<span class="op">=</span><span class="va">theta</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">4</span><span class="op">)</span>      <span class="co"># initial vector of theta</span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"est"</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>,</span>
<span>            centerintercepts<span class="op">=</span><span class="cn">TRUE</span>, maxiter<span class="op">=</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span>  <span class="co">##   Estimated Skill Distribution</span></span>
<span>  <span class="co">##         F1    pi.k</span></span>
<span>  <span class="co">##   1 -1.988 0.24813</span></span>
<span>  <span class="co">##   2 -0.055 0.23313</span></span>
<span>  <span class="co">##   3  0.940 0.40059</span></span>
<span>  <span class="co">##   4  2.000 0.11816</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 5: Multidimensional latent class IRT model</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="co"># We simulate a two-dimensional IRT model in which theta vectors</span></span>
<span><span class="co"># are observed at a fixed discrete grid (see below).</span></span>
<span></span>
<span><span class="co"># simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">754</span><span class="op">)</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fl">13</span>     <span class="co"># number of items</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">2400</span>   <span class="co"># number of persons</span></span>
<span></span>
<span><span class="co"># simulate Dimension 1 at 4 discrete theta points</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span><span class="op">/</span><span class="fl">4</span>,<span class="va">N</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">*</span><span class="va">N</span><span class="op">/</span><span class="fl">8</span>, <span class="va">N</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>  <span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span>,len<span class="op">=</span><span class="va">I</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexanderrobitzsch/sirt" class="external-link">sirt</a></span><span class="op">)</span>  <span class="co"># use simulation function from sirt package</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sirt/man/sim.raschtype.html" class="external-link">sim.raschtype</a></span><span class="op">(</span> theta<span class="op">=</span><span class="va">theta</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="co"># simulate Dimension 2 at 4 discrete theta points</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="op">-</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">1.5</span>, <span class="fl">2</span> <span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span> <span class="va">theta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">N</span><span class="op">/</span><span class="fl">4</span>,<span class="va">N</span><span class="op">/</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">*</span><span class="va">N</span><span class="op">/</span><span class="fl">8</span>, <span class="va">N</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>  <span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu">sirt</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sirt/man/sim.raschtype.html" class="external-link">sim.raschtype</a></span><span class="op">(</span> theta<span class="op">=</span><span class="va">theta</span>, b<span class="op">=</span><span class="va">b</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span> <span class="st">"I"</span>, <span class="st">"U"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">dat1</span>, <span class="va">dat2</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># define Q-matrix</span></span>
<span><span class="va">Qmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">I</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Qmatrix</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">I</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each<span class="op">=</span><span class="va">I</span><span class="op">)</span> <span class="op">)</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, len<span class="op">=</span><span class="fl">4</span><span class="op">)</span>      <span class="co"># initial matrix</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span> <span class="va">theta.k</span>, <span class="va">theta.k</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">theta.k</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Dim1"</span>,<span class="st">"Dim2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># estimate model</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, skillspace<span class="op">=</span><span class="st">"est"</span>, irtmodel<span class="op">=</span><span class="st">"1PL"</span>,</span>
<span>              Qmatrix<span class="op">=</span><span class="va">Qmatrix</span>, centerintercepts<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span>
<span>  <span class="co">##   Estimated Skill Distribution</span></span>
<span>  <span class="co">##     theta.k.Dim1 theta.k.Dim2    pi.k</span></span>
<span>  <span class="co">##   1       -2.022       -3.035 0.25010</span></span>
<span>  <span class="co">##   2        0.016        0.053 0.24794</span></span>
<span>  <span class="co">##   3        0.956        1.525 0.36401</span></span>
<span>  <span class="co">##   4        1.958        1.919 0.13795</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 6: Large-scale dataset data.mg</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">data.mg</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">data.mg</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"I"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">11</span> <span class="op">)</span> <span class="op">]</span></span>
<span><span class="va">theta.k</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>,<span class="fl">6</span>,len<span class="op">=</span><span class="fl">21</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#***</span></span>
<span><span class="co"># Model 1: Generalized partial credit model with multiple groups</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">gdm</span><span class="op">(</span> <span class="va">dat</span>, irtmodel<span class="op">=</span><span class="st">"2PL"</span>, theta.k<span class="op">=</span><span class="va">theta.k</span>, group<span class="op">=</span><span class="fu">CDM</span><span class="fu">::</span><span class="va"><a href="data.mg.html">data.mg</a></span><span class="op">$</span><span class="va">group</span>,</span>
<span>              skillspace<span class="op">=</span><span class="st">"normal"</span>, standardized.latent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Robitzsch, Thomas Kiefer, Ann Cathrice George, Ali Uenlue.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

