<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations — modelfit.cor • CDM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations — modelfit.cor"><meta property="og:description" content="This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp;amp; Zhang, 2013; see Details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">8.3</span
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/alexanderrobitzsch/CDM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Assessing Model Fit and Local Dependence by Comparing Observed and Expected
Item Pair Correlations</h1>
    
    <div class="hidden name"><code>modelfit.cor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes several measures of absolute model fit and local
dependence indices for dichotomous item responses which are
based on comparing observed and expected frequencies of item pairs
(Chen, de la Torre &amp; Zhang, 2013; see Details).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modelfit.cor</span><span class="op">(</span><span class="va">data</span>, <span class="va">posterior</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="fu">modelfit.cor2</span><span class="op">(</span><span class="va">data</span>, <span class="va">posterior</span>, <span class="va">probs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">modelfit.cor.din</span><span class="op">(</span> <span class="va">dinobj</span>, jkunits<span class="op">=</span><span class="fl">0</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for modelfit.cor.din</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>An \(N \times I\) data frame of dichotomous item responses</p></dd>

  <dt>posterior</dt>
<dd><p>A matrix containing the posterior distribution (e.g. obtained as
an output of the <code><a href="din.html">din</a></code> function).</p></dd>

  <dt>probs</dt>
<dd><p>An array of dimension [items,categories,attribute classes]
containing probabilities</p></dd>

<dt>dinobj</dt>
<dd><p>An object of class <code><a href="din.html">din</a></code>, <code><a href="gdina.html">gdina</a></code> or
 <code><a href="gdm.html">gdm</a></code> (only for dichotomous item responses)</p></dd>

<dt>object</dt>
<dd><p>An object of class <code><a href="din.html">din</a></code>, <code><a href="gdina.html">gdina</a></code> or
 <code><a href="gdm.html">gdm</a></code> (only for dichotomous item responses)</p></dd>

<dt>jkunits</dt>
<dd><p>Number of Jackknife units. The default is to use 0 units
    (no use of jackknifing). If jackknife estimation should be
    employed, use (say) at least 20 jackknife units.
The input <code>jkunits</code> can be also a vector of jackknife unit identifiers.</p></dd>

<dt>...</dt>
<dd><p>Further arguments to be passed</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The fit statistics are based on predictions of the pairwise table
\((X_i, X_j)\) of item responses. The \(\chi^2\) statistic <code>X2</code> for
item pairs \(i\) and \(j\) is defined as
$$ \chi^2_{ij}=\sum_{k=0}^1 \sum_{l=0}^1 \frac{ (n_{ij,kl}-e_{ij,kl}) ^2 }{ e_{ij,kl} }$$
where \(n_{ij,kl}\) is the absolute frequency of \(\{ X_{i}=k,X_j=l\}\)
and \(e_{ij,kl}\) is the expected frequency using the estimated model.
Note that for calculating \(e_{ij,kl}\), individual posterior distributions
are evaluated.  The \(\chi^2_{ij} \) statistic is chi-square distributed with one
degree of freedom and can be used for testing whether items \(i\) and
\(j\) are locally dependent. To control for multiple comparisons,
p-value adjustments according to the Holm and FDR method are conducted
(see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust</a></code>).</p>
<p><!-- % The mean \eqn{\chi^2} statistic \code{MX2} is just the average -->
<!-- % of all \eqn{ \chi^2_{ij}} statistics across all item pairs. --></p>
<p>The residual covariance <code>RESIDCOV</code> of item pairs \((i,j)\) is calculated
as $$ RESIDCOV_{ij}=
    \frac{ n_{ij,11} n_{ij,00} - n_{ij,10} n_{ij,01} }{n^2 } -
        \frac{ e_{ij,11} e_{ij,00} - e_{ij,10} e_{ij,01} }{n^2 } $$
where <code>MRESIDCOV</code> is the average of all <code>RESIDCOV</code> statistics
and is the total sample size.</p>
<p>The statistic <code>MADcor</code> denotes the average absolute deviation between
observed correlations \(r_{ij}\) and model predicted correlations
\(\hat{r}_{ij}\) of item pairs \((i,j)\):
$$ MADcor=\frac{1}{ J(J-1)/2 } \sum_{i &lt; j} | r_{ij} - \hat{r}_{ij} |$$</p>
<p>The SRMSR (standardized root mean square root of squared residuals,
Maydeu-Olivares, 2013) is also based on comparing these correlations
$$ SRMSR=\sqrt{ \frac{1}{ J(J-1)/2 } \sum_{i &lt; j}
    ( r_{ij} - \hat{r}_{ij} )^2 } $$</p>
<p>For calculating <code>MADQ3</code> and <code>MADaQ3</code>,
residuals \(\varepsilon_{ni}=X_{ni} - e_{ni}\) of
observed and expected responses for respondents \(n\) and items \(i\) are
constructed. Then, the average of the absolute values of pairwise correlations
of these residuals is computed for <code>MADQ3</code>. For <code>MADaQ3</code>, the average
of the centered pairwise values (i.e. by subtracting the average Q3 statistic)
is calculated.</p>
<p>The difference of Fisher transformed correlations (Chen et al., 2013) is also
computed and used for assessing statistical inference.</p>
<p>For every of the fit statistics <code>MADcor</code>, <code>MADacor</code>, <code>SRMSR</code>, <code>MX2</code>,
<code>100*MADRESIDCOV</code> and <code>MADQ3</code> it holds that smaller values
(values near to zero) indicate better fit.</p>
<p>Standard errors and confidence intervals of fit statistics are obtained
by Jackknife estimation.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with following entries</p>
<dl><dt>modelfit.stat</dt>
<dd><p>Model fit statistics:</p>
<p><code>MADcor</code>: mean of absolute deviations in observed and expected correlations
        (DiBello, Roussos &amp; Stout, 2007)</p>
<p><code>SRMSR</code>: standardized mean square root of squared residuals
        (Maydeu-Olivares, 2013; Maydeu-Olivares &amp; Joe, 2014)</p>
<p><!-- %    \code{MX2}: Mean of \eqn{\chi^2} statistics of all item pairs -->
<!-- %    (Chen &amp; Thissen, 1997) --></p>
<p><code>MADRESIDCOV</code>: Mean of absolute deviations of residual covariances
    (McDonald &amp; Mok, 1995)</p>
<p><code>MADQ3</code>: Mean of absolute values of \(Q_3\) statistic (Yen, 1984)</p>
<p><code>MADaQ3</code>: Mean of absolute values of centered \(Q_3\) statistic</p>
<p></p></dd>

<dt>modelfit.test</dt>
<dd><p>Test of global absolute model fit using test
    statistics of all item pairs. The statistic <code>max(X2)</code> is the
    maximum of all \(\chi^2_{ij}\) statistics accompanied with a p value
    obtained by the Holm procedure. A similar statistic <code>abs(fcor)</code>
    is created as the absolute value of the deviations of Fisher
    transformed correlations as used in Chen et al. (2013).</p></dd>

  <dt>itempairs</dt>
<dd><p>Fit of itempairs which can be used for inspection of local
        dependence. The \(\chi^2_{ij}\) statistic is denoted by <code>X2</code>
        (Chen &amp; Thissen, 1997), the statistic \(r_{ij}\) based on absolute
        deviations of observed and predicted correlations is <code>fcor</code>
        (Chen et al., 2013).</p></dd>


</dl></div>
    <div id="references">
    <h2>References</h2>
    <p>Chen, J., de la Torre, J., &amp; Zhang, Z. (2013).
Relative and absolute fit evaluation in cognitive diagnosis modeling.
<em>Journal of Educational Measurement, 50</em>, 123-140.</p>
<p>Chen, W., &amp; Thissen, D. (1997). Local dependence indexes for item pairs
using item response theory. <em>Journal of Educational and Behavioral Statistics,
22</em>, 265-289.</p>
<p>DiBello, L. V., Roussos, L. A., &amp; Stout, W. F. (2007). Review of
cognitively diagnostic assessment and a summary of psychometric models.
In C. R. Rao and S. Sinharay (Eds.), <em>Handbook of Statistics</em>,
Vol. 26 (pp. 979--1030). Amsterdam: Elsevier.</p>
<p>Maydeu-Olivares, A. (2013). Goodness-of-fit assessment of item response
theory models (with discussion).
<em>Measurement: Interdisciplinary Research and Perspectives,
11</em>, 71-137.</p>
<p>Maydeu-Olivares, A., &amp; Joe, H. (2014). Assessing approximate fit in categorical
data analysis. <em>Multivariate Behavioral Research, 49</em>, 305-328.</p>

<p>McDonald, R. P., &amp; Mok, M. M.-C. (1995). Goodness of fit in item response models.
<em>Multivariate Behavioral Research, 30</em>, 23-40.</p>
<p>Yen, W. M. (1984). Effects of local item dependence on the fit and equating
performance of the three-parameter logistic model.
<em>Applied Psychological Measurement, 8</em>, 125-145.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The function does not handle sample weights properly.</p>
<p>The function <code>modelfit.cor2</code> has the same functionality as
<code>modelfit.cor</code> but it is much faster because it is based on
<span class="pkg">Rcpp</span> code.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 1: Model fit for sim.dina</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim.dina</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sim.qmatrix</span>, package<span class="op">=</span><span class="st">"CDM"</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">sim.dina</span></span>
<span><span class="va">q.matrix</span> <span class="op">&lt;-</span> <span class="va">sim.qmatrix</span></span>
<span></span>
<span><span class="co">#*** Model 1: DINA model for DINA simulated data</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="din.html">din</a></span><span class="op">(</span><span class="va">dat</span>, q.matrix<span class="op">=</span><span class="va">q.matrix</span>, rule<span class="op">=</span><span class="st">"DINA"</span> <span class="op">)</span></span>
<span><span class="va">fmod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">modelfit.cor.din</span><span class="op">(</span><span class="va">mod1</span>, jkunits<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod1</span><span class="op">)</span></span>
<span>  <span class="co">##   Test of Global Model Fit</span></span>
<span>  <span class="co">##          type value     p</span></span>
<span>  <span class="co">##   1   max(X2) 8.728 0.113</span></span>
<span>  <span class="co">##   2 abs(fcor) 0.143 0.080</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">##   Fit Statistics</span></span>
<span>  <span class="co">##                     est jkunits jk_est jk_se est_low est_upp</span></span>
<span>  <span class="co">##   MADcor          0.030      10  0.020 0.005   0.010   0.030</span></span>
<span>  <span class="co">##   SRMSR           0.040      10  0.023 0.006   0.011   0.035</span></span>
<span>  <span class="co">##   100*MADRESIDCOV 0.671      10  0.445 0.125   0.200   0.690</span></span>
<span>  <span class="co">##   MADQ3           0.062      10  0.037 0.008   0.021   0.052</span></span>
<span>  <span class="co">##   MADaQ3          0.059      10  0.034 0.008   0.019   0.050</span></span>
<span></span>
<span><span class="co"># look at first five item pairs with highest degree of local dependence</span></span>
<span><span class="va">itempairs</span> <span class="op">&lt;-</span> <span class="va">fmod1</span><span class="op">$</span><span class="va">itempairs</span></span>
<span><span class="va">itempairs</span> <span class="op">&lt;-</span> <span class="va">itempairs</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span> <span class="va">itempairs</span><span class="op">$</span><span class="va">X2</span>, decreasing<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">itempairs</span><span class="op">[</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"item1"</span>,<span class="st">"item2"</span>, <span class="st">"X2"</span>, <span class="st">"X2_p"</span>, <span class="st">"X2_p.holm"</span>, <span class="st">"Q3"</span><span class="op">)</span> <span class="op">]</span></span>
<span>  <span class="co">##      item1 item2       X2        X2_p X2_p.holm          Q3</span></span>
<span>  <span class="co">##   29 Item5 Item8 8.728248 0.003133174 0.1127943 -0.26616414</span></span>
<span>  <span class="co">##   32 Item6 Item8 2.644912 0.103881881 1.0000000  0.04873154</span></span>
<span>  <span class="co">##   21 Item3 Item9 2.195011 0.138458201 1.0000000  0.05948456</span></span>
<span>  <span class="co">##   10 Item2 Item4 1.449106 0.228671389 1.0000000 -0.08036216</span></span>
<span>  <span class="co">##   30 Item5 Item9 1.393583 0.237800911 1.0000000 -0.01934420</span></span>
<span></span>
<span><span class="co">#*** Model 2: DINO model for DINA simulated data</span></span>
<span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="din.html">din</a></span><span class="op">(</span><span class="va">dat</span>, q.matrix<span class="op">=</span><span class="va">q.matrix</span>, rule<span class="op">=</span><span class="st">"DINO"</span> <span class="op">)</span></span>
<span><span class="va">fmod2</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">modelfit.cor.din</span><span class="op">(</span><span class="va">mod2</span>, jkunits<span class="op">=</span><span class="fl">10</span> <span class="op">)</span>   <span class="co"># 10 jackknife units</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod2</span><span class="op">)</span></span>
<span>  <span class="co">##   Test of Global Model Fit</span></span>
<span>  <span class="co">##          type  value     p</span></span>
<span>  <span class="co">##   1   max(X2) 13.139 0.010</span></span>
<span>  <span class="co">##   2 abs(fcor)  0.199 0.001</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">##   Fit Statistics</span></span>
<span>  <span class="co">##                     est jkunits jk_est jk_se est_low est_upp</span></span>
<span>  <span class="co">##   MADcor          0.056      10  0.041 0.007   0.026   0.055</span></span>
<span>  <span class="co">##   SRMSR           0.072      10  0.045 0.019   0.007   0.083</span></span>
<span>  <span class="co">##   100*MADRESIDCOV 1.225      10  0.878 0.183   0.519   1.236</span></span>
<span>  <span class="co">##   MADQ3           0.073      10  0.055 0.012   0.031   0.080</span></span>
<span>  <span class="co">##   MADaQ3          0.073      10  0.066 0.012   0.042   0.089</span></span>
<span></span>
<span><span class="co">#*** Model 3: estimate DINA model with gdina function</span></span>
<span><span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="gdina.html">gdina</a></span><span class="op">(</span> <span class="va">dat</span>, q.matrix<span class="op">=</span><span class="va">q.matrix</span>, rule<span class="op">=</span><span class="st">"DINA"</span> <span class="op">)</span></span>
<span><span class="va">fmod3</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">modelfit.cor.din</span><span class="op">(</span> <span class="va">mod3</span>, jkunits<span class="op">=</span><span class="fl">0</span> <span class="op">)</span>  <span class="co"># no Jackknife estimation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod3</span><span class="op">)</span></span>
<span>  <span class="co">##   Test of Global Model Fit</span></span>
<span>  <span class="co">##          type value     p</span></span>
<span>  <span class="co">##   1   max(X2) 8.756 0.111</span></span>
<span>  <span class="co">##   2 abs(fcor) 0.143 0.078</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">##   Fit Statistics</span></span>
<span>  <span class="co">##                     est</span></span>
<span>  <span class="co">##   MADcor          0.030</span></span>
<span>  <span class="co">##   SRMSR           0.040</span></span>
<span>  <span class="co">##   MX2             0.719</span></span>
<span>  <span class="co">##   100*MADRESIDCOV 0.668</span></span>
<span>  <span class="co">##   MADQ3           0.062</span></span>
<span>  <span class="co">##   MADaQ3          0.059</span></span>
<span></span>
<span><span class="co">#############################################################################</span></span>
<span><span class="co"># EXAMPLE 2: Simulated Example DINA model</span></span>
<span><span class="co">#############################################################################</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">9765</span><span class="op">)</span></span>
<span><span class="co"># specify Q-matrix</span></span>
<span><span class="va">Q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">0</span>,<span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">1</span> <span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">2</span>, byrow<span class="op">=</span><span class="cn">TRUE</span> <span class="op">)</span></span>
<span><span class="va">q.matrix</span> <span class="op">&lt;-</span> <span class="va">Q</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">q.matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate data</span></span>
<span><span class="va">guess</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">I</span>, <span class="fl">0</span>, <span class="fl">.3</span> <span class="op">)</span></span>
<span><span class="va">slip</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span> <span class="va">I</span>, <span class="fl">0</span>, <span class="fl">.4</span> <span class="op">)</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">150</span>   <span class="co"># number of persons</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="sim.din.html">sim.din</a></span><span class="op">(</span> N<span class="op">=</span><span class="va">N</span>, q.matrix<span class="op">=</span><span class="va">q.matrix</span>, slip<span class="op">=</span><span class="va">slip</span>, guess<span class="op">=</span><span class="va">guess</span> <span class="op">)</span><span class="op">$</span><span class="va">dat</span></span>
<span></span>
<span><span class="co">#*** estmate DINA model</span></span>
<span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu"><a href="din.html">din</a></span><span class="op">(</span> <span class="va">dat</span>, q.matrix<span class="op">=</span><span class="va">q.matrix</span>, rule<span class="op">=</span><span class="st">"DINA"</span> <span class="op">)</span></span>
<span><span class="va">fmod1</span> <span class="op">&lt;-</span> <span class="fu">CDM</span><span class="fu">::</span><span class="fu">modelfit.cor.din</span><span class="op">(</span><span class="va">mod1</span>, jkunits<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fmod1</span><span class="op">)</span></span>
<span>  <span class="co">##  Test of Global Model Fit</span></span>
<span>  <span class="co">##         type  value     p</span></span>
<span>  <span class="co">##  1   max(X2) 10.697 0.071</span></span>
<span>  <span class="co">##  2 abs(fcor)  0.277 0.026</span></span>
<span>  <span class="co">##</span></span>
<span>  <span class="co">##  Fit Statistics</span></span>
<span>  <span class="co">##                    est jkunits jk_est jk_se est_low est_upp</span></span>
<span>  <span class="co">##  MADcor          0.052      10  0.026 0.010   0.006   0.045</span></span>
<span>  <span class="co">##  SRMSR           0.074      10  0.048 0.013   0.022   0.074</span></span>
<span>  <span class="co">##  100*MADRESIDCOV 1.259      10  0.646 0.213   0.228   1.063</span></span>
<span>  <span class="co">##  MADQ3           0.080      10  0.047 0.010   0.027   0.068</span></span>
<span>  <span class="co">##  MADaQ3          0.079      10  0.046 0.010   0.027   0.065</span></span>
<span><span class="op">}</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Alexander Robitzsch.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

